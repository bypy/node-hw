<!doctype html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>Vote</title>
            
            <style>
                html { 
                    font-size: 100%;
                    font-family: Verdana, Geneva, Tahoma, sans-serif;
                }
                
                html, body {
                    height: 100%;
                    margin: 0;
                }
                
                .container {
                    position: relative;
                    min-height: 100%;
                    width: 80%;
                    max-width: 500px;
                    margin: 0 auto;
                    background-color: #fff;
                }
                
                .vote-page__content {
                    position: absolute;
                    width: 100%;
                    height: 50%;
                    top: 30%;
                    border-radius: 2em;
                    background-color: #fee;
                    z-index: 102;
                }
                
                .content__illustr {
                    position: absolute;
                    top:6%;
                    width: 60%;
                    max-width: 190px;
                    height: 25%;
                    left: 50%;
                    transform: translateX(-50%);
                    background-image: url(pic.jpg);
                    background-size: auto 100%;
                    background-position: center center;
                    background-color: transparent;
                    background-repeat: no-repeat;
                    border-radius: 2em 2em 0 0;
                    z-index: 100;
                }
                
                .vote-table__heading {
                    padding-left: 1em;
                    padding-right: 1em;
                    margin: .5em 0;
                    font-size: 150%;
                    text-align: center;
                    color:#f35656
                }

                .vote-table__body {
                    width: 100%;
                    font-size: 90%;
                }

                .vote-table__wrapper {
                    padding-left: 2em;
                    padding-right: 2em;
                }
                                
                .vote-table__question input {
                    white-space: normal;
                    padding-top: .25em;
                    padding-bottom: .25em;
                    border-radius: 1ex;
                }

                .vote-table__result {
                    text-align: right;
                }

                .content__form {
                    background-color: #fdd;
                    z-index: 2;
                }
            </style>
        </head>
        <body>
            <div class="container">
                <div class="vote-page__content">
                    <h2 class="vote-table__heading">Кто хочет сегодня поработать?!</h2>
                        <div class="vote-table__wrapper">

                        </div>
                </div>
                <div class="content__illustr"></div>
            </div>
            <script>
                'use strict';
        
                const buildVoteForm = () => {
                    
                    let tableWrapper = document.querySelector('.vote-table__wrapper');
                    let variantsURL = 'http://localhost:8089/variants';
                    let statURL = 'http://localhost:8089/stat';
                    
                    const performRequest = function(url, params) { 
                        params = params || {};
                        const request = new Request(url, params);
                        return new Promise( (resolve, reject) => {
                            fetch(request)
                                .then(response => {
                                    if (response.status === 200) {
                                        resolve(response.json());
                                    } else {
                                        throw new Error('Something went wrong on api server!');
                                    }
                                })
                    
                        });
                    };

                    const getStat = () => {
                        const params = {
                            method:'POST'
                        };
                        return performRequest(statURL, params);
                    };

                    const getVariants = () => performRequest(variantsURL);
                    
                    let createInputs = (stat, questions) =>
                        questions.map(q => 
                            `<tr>
                                <td class='vote-table__question'>
                                    <input type='button' name='${q.code}' value='${q.text}'></td>
                                <td class='vote-table__result'>${stat[q.code]}</td>
                            </tr>`
                        ).join('\n');
                    
                    let createQuestionTable = inputs => 
                        `<table class='vote-table__body'>
                            <tbody>
                                ${inputs}
                            <tbody>
                        </table>`;
                    
                    //let getVariants = performRequest(variantsURL);
                    Promise.all([getStat(), getVariants()])
                        .then(values => {
                            console.log(values);
                            let stats = values[0];
                            let variants = values[1];
                            let inputs = createInputs(stats, variants);
                            let questionTable = createQuestionTable(inputs);
                            tableWrapper.innerHTML = questionTable;
                        })
                        .catch(function(e) {
                            console.log(e);
                        })
                    ;
                    
                    // getStat(statURL)
                    //     .then( response => {
                    //         console.log(JSON.stringify(response));
                    //         console.log(response.code);
                    //     })
                    // ;
                    
                    // getVariants(variantsURL)
                    //     .then( questions => createInputs(questions) )
                    //     .then( inputs => createQuestionTable(inputs) )
                    //     .then( voteTable => {
                    //         tableWrapper.innerHTML = voteTable;
                    //     })
                    //     .catch(function(e) {
                    //         console.log(e);
                    //     })
                    // ;






                }; // buildVoteForm

                window.addEventListener('DOMContentLoaded', buildVoteForm);
            </script>
        </body>
        </html>